<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Cat√°logo de produtos online">
  <title>Cat√°logo de Produtos</title>
  <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>
  <!-- Preloader -->
  <div class="page-loader" id="pageLoader">
    <div class="loader-spinner"></div>
    <p>Carregando cat√°logo...</p>
  </div>

  <!-- Header Fixo -->
  <div class="header-sticky">
    <!-- Aviso de Taxa de Entrega -->
    <div class="aviso-entrega" id="avisoEntrega" style="display: none;">
      <div class="container">
        <span class="aviso-icon">üèçÔ∏è</span>
        <span class="aviso-texto">Taxa de Entrega Via Motoboy: <strong id="valorTaxa">R$ 8,00</strong></span>
      </div>
    </div>

    <!-- Header Principal -->
    <header class="header">
      <div class="container header-flex">
        <!-- Logo -->
        <div id="logoContainer" class="logo-container">
          <span id="nomeLoja">Carregando...</span>
        </div>

        <!-- Menu Desktop -->
        <nav class="menu-categorias-desktop" id="menuCategoriasDesktop">
          <div class="categorias-scroll">
            <button class="categoria-item active" data-categoria="todas">
              Todas
            </button>
          </div>
        </nav>

        <!-- Bot√£o Filtros Mobile -->
        <button class="btn-filtros-mobile" id="btnFiltrosMobile">
          <span class="icon">‚öôÔ∏è</span>
          Filtros
        </button>
      </div>
    </header>
  </div>

  <!-- Aviso Informativo Destacado -->
  <div class="aviso-info-destaque" id="avisoInfo" style="display: none;">
    <div class="container">
      <div class="aviso-content">
        <p class="aviso-texto" id="avisoInfoTexto"></p>
        <a href="#" class="btn-aviso" id="btnAvisoInfo" target="_blank"></a>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <!-- Overlay para filtros mobile -->
      <div class="filtros-overlay" id="filtrosOverlay"></div>

      <!-- Sidebar de Filtros (Fixo) -->
      <aside class="filtros-sidebar-fixed" id="filtrosSidebar">
        <div class="filtros-header">
          <h2>Filtros</h2>
          <button class="btn-fechar-filtros" id="btnFecharFiltros">‚úï</button>
        </div>

        <div class="filtros-content">
          <!-- Busca Simples -->
          <div class="filtro-grupo">
            <h3>Buscar</h3>
            <input type="text" id="campoBusca" class="campo-busca" placeholder="Digite para buscar...">
          </div>

          <!-- Filtros de Marca -->
          <div class="filtro-grupo">
            <h3>Marca</h3>
            <div id="filtrosMarca" class="filtro-opcoes">
              <!-- Gerado dinamicamente -->
            </div>
          </div>

          <!-- Filtros de Tamanho -->
          <div class="filtro-grupo">
            <h3>Tamanho</h3>
            <div id="filtrosTamanho" class="filtro-opcoes">
              <!-- Gerado dinamicamente -->
            </div>
          </div>

          <button id="btnLimparFiltros" class="btn-limpar-full">Limpar Filtros</button>
        </div>
      </aside>

      <!-- √Årea de Produtos -->
      <section class="produtos-area">
        <div class="produtos-header">
          <h2>Produtos</h2>
          <p id="contadorProdutos" class="contador">0 produtos</p>
        </div>

        <!-- Produtos por Categoria -->
        <div id="produtosPorCategoria">
          <!-- Gerado dinamicamente -->
        </div>
      </section>
    </div>
  </main>

  <!-- WhatsApp Flutuante -->
  <div class="whatsapp-flutuante" id="whatsappFlutuante" style="display: none;">
    <div class="whatsapp-tooltip" id="whatsappTooltip">Precisa de Ajuda?</div>
    <a href="#" class="whatsapp-btn" id="whatsappBtnFlutuante" target="_blank">
      <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
        <path d="M16 0C7.163 0 0 7.163 0 16c0 2.825.738 5.487 2.038 7.787L0 32l8.4-2.2A15.93 15.93 0 0016 32c8.837 0 16-7.163 16-16S24.837 0 16 0zm0 29.45c-2.55 0-4.95-.7-7.025-1.9l-.5-.3-5.188 1.363 1.388-5.063-.325-.525A13.363 13.363 0 012.55 16c0-7.425 6.038-13.45 13.45-13.45S29.45 8.575 29.45 16 23.425 29.45 16 29.45z" fill="#fff"/>
        <path d="M23.738 19.463c-.4-.2-2.363-1.163-2.725-1.3-.363-.125-.625-.188-.888.2-.263.375-1.013 1.3-1.238 1.563-.225.263-.45.3-.85.1-.4-.2-1.7-.625-3.238-2-.2-.213-3.063-2.663-3.063-2.663s-.363-.45-.138-.688c.188-.2.4-.525.6-.788.2-.262.263-.45.4-.712.137-.263.075-.525-.037-.725-.113-.2-1.113-2.663-1.525-3.65-.4-.963-.8-.825-1.1-.838-.275-.013-.6-.013-.875-.013s-.8.113-1.225.563c-.425.45-1.625 1.588-1.625 3.863s1.663 4.475 1.888 4.775c.238.3 3.313 5.063 8.013 7.088 4.7 2.025 4.7.675 5.55.625.85-.05 2.738-1.125 3.125-2.2.388-1.075.388-2 .275-2.2-.113-.2-.413-.313-.813-.513z" fill="#fff"/>
      </svg>
    </a>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container footer-content">
      <p class="footer-copy">&copy; 2025 <span id="nomeLojaFooter">Cat√°logo</span>. Todos os direitos reservados.</p>
      <p class="footer-creditos">
        Desenvolvido por 
        <a href="https://instagram.com/mateusfams" target="_blank" class="dev-link">
          Mateus Andrade
        </a>
      </p>
    </div>
  </footer>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <!-- Configura√ß√£o Firebase -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAZ90xAptvBeRDFl52FI7-WJJD14I6YKk4",
  authDomain: "drak-feet-admin.firebaseapp.com",
  projectId: "drak-feet-admin",
  storageBucket: "drak-feet-admin.firebasestorage.app",
  messagingSenderId: "525123704162",
  appId: "1:525123704162:web:ea0a3bc86663334a79c83b",
  measurementId: "G-EFERT7RZZ5"
    };

    firebase.initializeApp(firebaseConfig);
    console.info('‚úÖ Firebase inicializado');
  </script>

  <!-- Scripts -->
  <script src="assets/js/data.service.js"></script>
  <script src="assets/js/tracking.service.js"></script>
  <script src="assets/js/catalog.render.js"></script>
  <script src="assets/js/filters.js"></script>

  <!-- Inicializa√ß√£o -->
  <script>
    async function inicializarCatalogo() {
      try {
        DataService.init();

        const config = await DataService.buscarConfig();
        
        // Nome da loja
        document.getElementById('nomeLojaFooter').textContent = config.nomeLoja;
        document.title = `${config.nomeLoja} - Cat√°logo`;
        
        // Logo ou nome
        const logoContainer = document.getElementById('logoContainer');
        if (config.logoUrl && config.logoUrl.trim() !== '') {
          logoContainer.innerHTML = `<img src="${config.logoUrl}" alt="${config.nomeLoja}" class="logo-img">`;
        } else {
          document.getElementById('nomeLoja').textContent = config.nomeLoja;
        }
        
        CatalogRender.setConfig(config);

        // Taxa de entrega
        if (config.taxaMotoboy && config.taxaMotoboy > 0) {
          const avisoDiv = document.getElementById('avisoEntrega');
          const valorSpan = document.getElementById('valorTaxa');
          valorSpan.textContent = `R$ ${config.taxaMotoboy.toFixed(2).replace('.', ',')}`;
          avisoDiv.style.display = 'block';
        }

        // Aviso informativo
        if (config.avisoTexto && config.avisoTexto.trim() !== '') {
          const avisoInfoDiv = document.getElementById('avisoInfo');
          const avisoTextoP = document.getElementById('avisoInfoTexto');
          const btnAviso = document.getElementById('btnAvisoInfo');
          
          avisoTextoP.textContent = config.avisoTexto;
          btnAviso.textContent = config.avisoBotaoTexto || 'Saiba Mais';
          btnAviso.href = config.avisoBotaoUrl || '#';
          avisoInfoDiv.style.display = 'block';
        }

        // WhatsApp flutuante
        if (config.whatsappFlutuante !== false) {
          const whatsappDiv = document.getElementById('whatsappFlutuante');
          const tooltip = document.getElementById('whatsappTooltip');
          const btn = document.getElementById('whatsappBtnFlutuante');
          
          tooltip.textContent = config.whatsappMensagemFlutuante || 'Precisa de Ajuda?';
          btn.href = `https://wa.me/${config.whatsapp}`;
          whatsappDiv.style.display = 'block';
        }

        TrackingService.init(config);

        CatalogRender.mostrarLoading();
        const produtos = await DataService.buscarProdutos();

        CatalogRender.renderizarPorCategorias(produtos);
        Filters.init(produtos, config);
        Filters.atualizarContadores(produtos.length);

        // Registrar visualiza√ß√£o de p√°gina
        await DataService.registrarVisualizacao();

        // Remover preloader
        setTimeout(() => {
          document.getElementById('pageLoader').classList.add('fade-out');
          setTimeout(() => {
            document.getElementById('pageLoader').style.display = 'none';
          }, 500);
        }, 800);

      } catch (error) {
        console.error('‚ùå Erro ao inicializar cat√°logo:', error);
        document.getElementById('pageLoader').innerHTML = `
          <div class="error-state">
            <p>‚ùå Erro ao carregar. Recarregue a p√°gina.</p>
          </div>
        `;
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', inicializarCatalogo);
    } else {
      inicializarCatalogo();
    }
  </script>
</body>
</html>